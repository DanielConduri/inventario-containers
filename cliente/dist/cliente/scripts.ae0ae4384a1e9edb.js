var AuthenticationContext,window,localStorage,angular,document,sessionStorage,tenant="d7f86710-01e1-461d-8599-758de4542e2b",clientId="e16a3a96-b0df-4555-a605-66dd5a3af0ef";typeof module<"u"&&module.exports&&(module.exports.inject=function(t,e,s,i,a,r){return window=t,localStorage=e,sessionStorage=e,document=s,Math=i,angular=a,new AuthenticationContext(r)}),(AuthenticationContext=function(t){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",ID_TOKEN:"ID_TOKEN",UNKNOWN:"UNKNOWN"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",START_PAGE:"adal.start.page",FAILED_RENEW:"adal.failed.renew",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",STATE_RENEW_RESOURCE:"adal.state.renew.resource",STATE_IDTOKEN:"adal.state.idtoken",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error"},RESOURCE_DELIMETER:"|",ERR_MESSAGES:{NO_TOKEN:"User is not authorized"}},AuthenticationContext.prototype._singletonInstance)return AuthenticationContext.prototype._singletonInstance;if(AuthenticationContext.prototype._singletonInstance=this,this.instance="https://login.windows.net/",this.config={},this.callback=null,this.popUp=!1,this._user=null,this._renewActive=!1,this._loginInProgress=!1,this._renewStates=[],t.displayCall&&"function"!=typeof t.displayCall)throw new Error("displayCall is not a function");if(!t.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(t),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href),this.config.resource=this.config.loginResource||""}).prototype.login=function(){var t=this._guid();this.config.state=t,this._idTokenNonce=this._guid(),this._logstatus("Expected state: "+t+" startPage:"+window.location),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,t),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce),this._saveItem(this.CONSTANTS.STORAGE.FAILED_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var e=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);this.frameCallInProgress=!1,this._loginInProgress=!0,this.config.displayCall?this.config.displayCall(e):this.promptUser(e)},AuthenticationContext.prototype.loginInProgress=function(){return this._loginInProgress},AuthenticationContext.prototype._hasResource=function(t){var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return e&&!this._isEmpty(e)&&e.indexOf(t+this.CONSTANTS.RESOURCE_DELIMETER)>-1},AuthenticationContext.prototype.getCachedToken=function(t){var e=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t);(""===e||null==e)&&(e=tokenCliente.access_token);var s=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t);(0==s||null==s)&&(s=tokenCliente.expires_on);var i=this.config.expireOffsetSeconds||120;return s&&s>this._now()+i?e:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,0),null)},AuthenticationContext.prototype.getCachedUser=function(){if(this._user)return this._user;var t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return null==t&&(t=tokenCliente.id_token),this._user=this._createUser(t),this._user},AuthenticationContext.prototype._renewToken=function(t,e){if(this._logstatus("renewToken is called for resource:"+t),!this._hasResource(t)){var s=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"";this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,s+t+this.CONSTANTS.RESOURCE_DELIMETER)}var i=this._addAdalFrame("adalRenewFrame"),a=this._guid()+"|"+t;this._idTokenNonce=this._guid(),this.config.state=a,this._renewStates.push(a),this._saveItem(this.CONSTANTS.STORAGE.FAILED_RENEW,""),this._logstatus("Renew token Expected state: "+a);var r=this._getNavigateUrl("token",t)+"&prompt=none&login_hint="+encodeURIComponent(this._user.userName);r+="&domain_hint="+encodeURIComponent(this._getDomainHint()),r+="&nonce="+encodeURIComponent(this._idTokenNonce),this.callback=e,this.idTokenNonce=null,this._logstatus("Navigate to:"+r),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),i.src="about:blank",this._loadFrame(r,"adalRenewFrame")},AuthenticationContext.prototype._renewIdToken=function(t){if(this._logstatus("renewIdToken is called"),!this._hasResource(this.config.clientId)){var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"";this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,e+this.config.clientId+this.CONSTANTS.RESOURCE_DELIMETER)}var s=this._addAdalFrame("adalIdTokenFrame"),i=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce),this.config.state=i,this._renewStates.push(i),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,i),this._saveItem(this.CONSTANTS.STORAGE.FAILED_RENEW,""),this._logstatus("Renew token Expected state: "+i);var a=this._getNavigateUrl("id_token",null)+"&prompt=none&login_hint="+encodeURIComponent(this._user.userName);a+="&domain_hint="+encodeURIComponent(this._getDomainHint()),a+="&nonce="+encodeURIComponent(this._idTokenNonce),this.callback=t,this.idTokenNonce=null,this._logstatus("Navigate to:"+a),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),s.src="about:blank",this._loadFrame(a,"adalIdTokenFrame")},AuthenticationContext.prototype._loadFrame=function(t,e){var s=this;s._logstatus("LoadFrame: "+e);var i=e;setTimeout(function(){var a=s._addAdalFrame(i);(""===a.src||"about:blank"===a.src)&&(a.src=t,s._loadFrame(t,i))},500)},AuthenticationContext.prototype.acquireToken=function(t,e){if(!this._isEmpty(t)){var s=this.getCachedToken(t);return s?(this._logstatus("Token in cache"),void e(null,s)):this._getItem(this.CONSTANTS.STORAGE.FAILED_RENEW)?(this._logstatus("renewToken is failed:"+this._getItem(this.CONSTANTS.STORAGE.FAILED_RENEW)),void e(this._getItem(this.CONSTANTS.STORAGE.FAILED_RENEW),null)):void(this._user?(this._renewActive=!0,t===this.config.clientId?(this._logstatus("renewing idtoken"),this._renewIdToken(e)):this._renewToken(t,e)):e("User login is required",null))}e("resource is required",null)},AuthenticationContext.prototype.promptUser=function(t){t?(this._logstatus("Navigate to:"+t),window.location.replace(t)):this._logstatus("Navigate url is empty")},AuthenticationContext.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY,0),this._saveItem(this.CONSTANTS.STORAGE.FAILED_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.STATE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.START_PAGE,""),this._saveItem(this.CONSTANTS.STORAGE.USERNAME,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(t)){t=t.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var e=0;e<t.length;e++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t[e],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t[e],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},AuthenticationContext.prototype.clearCacheForResource=function(t){this._saveItem(this.CONSTANTS.STORAGE.FAILED_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(t)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,0))},AuthenticationContext.prototype.logOut=function(){this.clearCache();var t="common",e="";this._user=null,this.config.tenant&&(t=this.config.tenant),this.config.instance&&(this.instance=this.config.instance),this.config.postLogoutRedirectUri&&(e="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri));var s=this.instance+t+"/oauth2/logout?"+e;this._logstatus("Logout navigate to: "+s),this.promptUser(s)},AuthenticationContext.prototype._isEmpty=function(t){return typeof t>"u"||!t||0===t.length},AuthenticationContext.prototype.getUser=function(t){if("function"!=typeof t)throw new Error("callback is not a function");if(this.callback=t,this._user)this.callback(null,this._user);else{var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(e)?this.callback("User information is not available"):(this._logstatus("User exists in cache: "),this._user=this._createUser(e),this.callback(null,this._user))}},AuthenticationContext.prototype._getDomainHint=function(){if(this._user&&this._user.userName&&this._user.userName.indexOf("@")>-1){var t=this._user.userName.split("@");return t[t.length-1]}return""},AuthenticationContext.prototype._createUser=function(t){var e=null,s=this._extractIdToken(t);return s&&s.hasOwnProperty("aud")&&(s.aud.toLowerCase()===this.config.clientId.toLowerCase()?(e={userName:"",profile:s},s.hasOwnProperty("upn")?e.userName=s.upn:s.hasOwnProperty("email")&&(e.userName=s.email)):this._logstatus("IdToken has invalid aud field")),e},AuthenticationContext.prototype._getHash=function(t){return t.indexOf("#/")>-1?t=t.substring(t.indexOf("#/")+2):t.indexOf("#")>-1&&(t=t.substring(1)),t},AuthenticationContext.prototype.isCallback=function(t){t=this._getHash(t);var e=this._deserialize(t);return e.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||e.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||e.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},AuthenticationContext.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},AuthenticationContext.prototype.getRequestInfo=function(t){t=this._getHash(t);var e=this._deserialize(t),s={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(e&&(s.parameters=e,e.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||e.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||e.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){s.valid=!0;var i="";switch(e.hasOwnProperty("state")?(this._logstatus("State: "+e.state),i=e.state):this._logstatus("No state returned"),s.stateResponse=i,i){case this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN):s.requestType=this.REQUEST_TYPE.LOGIN,s.stateMatch=!0;break;case this._getItem(this.CONSTANTS.STORAGE.STATE_IDTOKEN):s.requestType=this.REQUEST_TYPE.ID_TOKEN,this._saveItem(this.CONSTANTS.STORAGE.STATE_IDTOKEN,""),s.stateMatch=!0}if(!s.stateMatch&&window.parent&&window.parent.AuthenticationContext())for(var a=window.parent.AuthenticationContext()._renewStates,r=0;r<a.length;r++)if(a[r]===s.stateResponse){s.requestType=this.REQUEST_TYPE.RENEW_TOKEN,s.stateMatch=!0;break}}return s},AuthenticationContext.prototype._getResourceFromState=function(t){if(t){var e=t.indexOf("|");if(e>-1&&e+1<t.length)return t.substring(e+1)}return""},AuthenticationContext.prototype.saveTokenFromHash=function(t){if(this._logstatus("State status:"+t.stateMatch),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),t.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION))this._logstatus("Error :"+t.parameters.error),this._logstatus("Error description:"+t.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.FAILED_RENEW,t.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,t.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,t.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),t.requestType===this.REQUEST_TYPE.LOGIN?(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,t.parameters.errorDescription)):this._renewActive=!1;else if(t.stateMatch){var e,s;this._logstatus("State is right"),t.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,t.parameters[this.CONSTANTS.SESSION_STATE]),t.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this._logstatus("Fragment has access token"),this._renewActive=!1,this._hasResource(s=this.config.loginResource)||(e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,e+s+this.CONSTANTS.RESOURCE_DELIMETER)),t.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&(s=this._getResourceFromState(t.stateResponse)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+s,t.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+s,this._expiresIn(t.parameters[this.CONSTANTS.EXPIRES_IN]))),t.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this._loginInProgress=!1,this._user=this._createUser(t.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile&&(this._user.profile.nonce!==this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)?(this._user=null,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce is not same as "+this._idTokenNonce)):(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,t.parameters[this.CONSTANTS.ID_TOKEN]),this._hasResource(s=this.config.clientId)||(e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,e+s+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+s,t.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+s,this._user.profile.exp))))}else this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state"),t.requestType===this.REQUEST_TYPE.LOGIN&&this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"State is not same as "+t.stateResponse)},AuthenticationContext.prototype.getResourceForEndpoint=function(t){if(this.config&&this.config.endpoints)for(var e in this.config.endpoints)if(t.indexOf(e)>-1)return this.config.endpoints[e];return this.config.loginResource},AuthenticationContext.prototype.handleWindowCallback=function(){var t=window.location.hash;if(this.isCallback(t)){var e=this.getRequestInfo(t);this.saveTokenFromHash(e);var s=null;if(e.requestType!==this.REQUEST_TYPE.RENEW_TOKEN&&e.requestType!==this.REQUEST_TYPE.ID_TOKEN||!window.parent?window&&window.oauth2Callback&&(s=this.callback):(s=window.parent.AuthenticationContext().callback,window.src=""),window.location.hash="",window.location=this._getItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST),e.requestType===this.REQUEST_TYPE.RENEW_TOKEN)return void s(this._getItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION),e.parameters[this.CONSTANTS.ACCESS_TOKEN]);if(e.requestType===this.REQUEST_TYPE.ID_TOKEN)return void s(this._getItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION),this._createUser(this._getItem(this.CONSTANTS.STORAGE.IDTOKEN)))}},AuthenticationContext.prototype._getNavigateUrl=function(t,e){var s="common";return this.config.tenant&&(s=this.config.tenant),this.config.instance&&(this.instance=this.config.instance),this.instance+s+"/oauth2/authorize"+this._serialize(t,this.config,e)+this._addClientId()},AuthenticationContext.prototype._extractIdToken=function(t){var e=this._decodeJwt(t);if(!e)return null;try{var i=this._base64DecodeStringUrlSafe(e.JWSPayload);return i?JSON.parse(i):(this._logstatus("The returned id_token could not be base64 url safe decoded."),null)}catch(a){this._logstatus("The returned id_token could not be decoded: "+a.stack)}return null},AuthenticationContext.prototype._extractUserName=function(t){try{var e=this._extractIdToken(t);if(e){if(e.hasOwnProperty("upn"))return e.upn;if(e.hasOwnProperty("email"))return e.email}}catch(s){this._logstatus("The returned id_token could not be decoded: "+s.stack)}return null},AuthenticationContext.prototype._base64DecodeStringUrlSafe=function(t){return t=t.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(t))):(this._logstatus("Browser is not supported"),null)},AuthenticationContext.prototype._decodeJwt=function(t){var s=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);return!s||s.length<4?(this._logstatus("The returned id_token is not parseable."),null):{header:s[1],JWSPayload:s[2],JWSSig:s[3]}},AuthenticationContext.prototype._convertUrlSafeToRegularBase64EncodedString=function(t){return t.replace("-","+").replace("_","/")},AuthenticationContext.prototype._serialize=function(t,e,s){var i=[];return null!==e&&(i.push("?response_type="+t),i.push("client_id="+encodeURIComponent(e.clientId)),s&&i.push("resource="+encodeURIComponent(s)),i.push("redirect_uri="+encodeURIComponent(e.redirectUri)),i.push("state="+encodeURIComponent(e.state)),e.hasOwnProperty("slice")&&i.push("slice="+encodeURIComponent(e.slice)),e.hasOwnProperty("extraQueryParameter")&&i.push(e.extraQueryParameter)),i.join("&")},AuthenticationContext.prototype._deserialize=function(t){var e,s=/\+/g,i=/([^&=]+)=?([^&]*)/g,a=function(o){return decodeURIComponent(o.replace(s," "))},r={};for(e=i.exec(t);e;)r[a(e[1])]=a(e[2]),e=i.exec(t);return r},AuthenticationContext.prototype._guid=function(){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",e="0123456789abcdef",s=0,i="",a=0;a<36;a++)"-"!==t[a]&&"4"!==t[a]&&(s=16*Math.random()|0),"x"===t[a]?i+=e[s]:"y"===t[a]?(s&=3,i+=e[s|=8]):i+=t[a];return i},AuthenticationContext.prototype._expiresIn=function(t){return this._now()+parseInt(t,10)},AuthenticationContext.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},AuthenticationContext.prototype._addAdalFrame=function(t){if(!(typeof t>"u")){this._logstatus("Add adal frame to document:"+t);var e=document.getElementById(t);if(!e){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var s=document.createElement("iframe");s.setAttribute("id",t),s.style.visibility="hidden",s.style.position="absolute",s.style.width=s.style.height=s.borderWidth="0px",e=document.getElementsByTagName("body")[0].appendChild(s)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+t+'" id="'+t+'" style="display:none"></iframe>');window.frames&&window.frames[t]&&(e=window.frames[t])}return e}},AuthenticationContext.prototype._logstatus=function(t){},AuthenticationContext.prototype._saveItem=function(t,e){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?(localStorage.setItem(t,e),!0):(this._logStatus("Local storage is not supported"),!1):this._supportsSessionStorage()?(sessionStorage.setItem(t,e),!0):(this._logstatus("Session storage is not supported"),!1)},AuthenticationContext.prototype._getItem=function(t){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(t):(this._logstatus("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(t):(this._logstatus("Session storage is not supported"),null)},AuthenticationContext.prototype._supportsLocalStorage=function(){try{return"localStorage"in window&&window.localStorage}catch{return!1}},AuthenticationContext.prototype._supportsSessionStorage=function(){try{return"sessionStorage"in window&&window.sessionStorage}catch{return!1}},AuthenticationContext.prototype._cloneConfig=function(t){if(null===t||"object"!=typeof t)return t;var e={};for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);return e},AuthenticationContext.prototype._libVersion=function(){return"1.0.0"},AuthenticationContext.prototype._addClientId=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()};var baseEndpoint="https://graph.microsoft.com",filesResource="https://"+tenant+"-my.sharepoint.com",endpoints={filesResource};function getDatos(){return{tenant,clientId}}window.config={tenant,clientId,postLogoutRedirectUri:window.location.origin,endpoints,cacheLocation:"localStorage"};var fileToUpload,authContext=new AuthenticationContext(config),tokenCliente="";function getTokenGenerado(t){tokenCliente=t;var e=authContext.isCallback(window.location.hash);authContext.handleWindowCallback(),e&&!authContext.getLoginError()&&(window.location=authContext._getItem(authContext.CONSTANTS.STORAGE.LOGIN_REQUEST)),authContext.getCachedUser()}function cargarData(t,e){return new Promise((s,i)=>{authContext.acquireToken(baseEndpoint,function(a,r){(a||!r)&&s(!1),fetch(baseEndpoint+`/v1.0/me/drive/root:/${t}/${e}`,{method:"GET",headers:{Authorization:"Bearer "+r}}).then(o=>o.json()).then(o=>{s(o)}).catch(o=>{console.log("Err",o),i(o)})})})}async function onUpload(t,e,s){fileToUpload=t;try{var a=fileToUpload.name.lastIndexOf(".")}catch{return}let r=fileToUpload.name.substring(a+1);return await getUploadSession(r,s,e)}function getUploadSession(t,e,s){return new Promise((i,a)=>{let r={item:{"@microsoft.graph.conflictBehavior":"replace"}};authContext.acquireToken(baseEndpoint,function(o,n){o||!n||fetch(baseEndpoint+`/v1.0/me/drive/root:/${s}/${e}.${t}:/createUploadSession`,{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Authorization:"Bearer "+n},body:JSON.stringify(r)}).then(h=>h.json()).then(async h=>{let T=h.uploadUrl;sessionStorage.setItem("urlDrive",h);let S=await uploadChunks(fileToUpload,T);i(S)}).catch(h=>{a()})})})}async function uploadChunks(t,e){new FileReader;for(var i=0,r=!0;r;){var o;try{r=!0;try{let n=i+327680;if(!((o=await readFragmentAsync(t,i,n)).byteLength>0))break;r=!0}catch{break}try{let n=await uploadChunk(o,e,i,t.size);if(202!==n.status&&201!==n.status&&200!==n.status)throw"La operaci\xf3n no devolvi\xf3 la respuesta esperada";201===n.status||200===n.status?r=!1:i=Number(n.json.nextExpectedRanges[0].split("-")[0])}catch{}}catch{r=!1}}return new Promise((n,h)=>{n(!0)})}function readFragmentAsync(t,e,s){const a=new FileReader;var r=t.slice(e,s);return a.readAsArrayBuffer(r),new Promise((o,n)=>{a.onloadend=h=>{a.readyState===a.DONE&&o(a.result)}})}function uploadChunk(t,e,s,i){var a=s+t.byteLength-1;return new Promise((r,o)=>{try{fetch(e,{method:"PUT",headers:{"Content-Range":"bytes "+s+"-"+a+"/"+i,"Content-Type":"application/octet-stream"},contentType:"application/octet-stream",body:t,processData:!1}).then(async h=>{results={},results.status=h.status,results.json=await h.json(),r(results)}).catch(h=>{})}catch(n){console.log("exception uploadChunk:  "+n),o(n)}})}